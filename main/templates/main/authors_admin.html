{% extends 'base.html' %}
{% block content %}
{% load static %}


<div class='container'>  
  <div class='row '>
    <div class="col-md-7 m-auto ">
      {% if messages %}
      <div class="alert alert-warning alert-dismissible fade show" role="alert">
          {% for message in messages %}
          <p{% if message.tags %} class="{{ message.tags }} text-center" {% endif %}>{{ message }}</p>
              {% endfor %}

              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
      </div>
      {% endif %}
  </div>
    <div class='col-lg-8 m-auto'>
      <h1 class="text-center">
       <br />
        Authors Dashboard
        <hr>
      </h1>
    </div>
    <div class='col-lg-12'>
      {% include 'snippets/search_users.html' %}
    </div>
    <div class='col-lg-12 text-center'>
      {% for a in alpha %}
      <a href="?beta={{a}}" class='alpha'>{{a|upper}}</a>
      {% endfor %}
      <a href="{% url 'main:authors_admin' %}" class='alpha'>All</a>
      <br>
      <br>
      <br>
    </div>
    <div class="col-lg-12">
      {% if page_obj %}
      <table class="table">
        <thead class="thead-dark">
          <tr>
            <th scope="col">#</th>
            <th scope="col">UserName</th>
            <th scope="col">Slug</th>
            <th scope="col">Email</th>
            <th scope="col">Status</th>
          </tr>
        </thead>
        <tbody>
          {% for user in page_obj.object_list %}
          <tr>
            <th scope="row">{{user.id}}</th>
            <td>{{user.username}}</td>
            <td>{{user.slug}}</td>
            <td>{{user.email}}</td>
            <td>
              <form method='post' action="{% url 'main:confirm_author' slug=user.slug %}">
                {% csrf_token %}
                <input type="hidden" name='status' value="{% if user.is_author %}delete {% else %} create{% endif %}" />
                <button user-slug='{{user.slug}}' id='author-control' class="btn 
                                       {% if user.is_author %}
                                            btn-danger
                                          {% else %}
                                            btn-info
                                          {% endif %}

                                  ">
                  {% if user.is_author %}
                  Remove Author
                  {% else %}
                  Add Author
                  {% endif %}
                </button>
              </form>

            </td>
          </tr>
          {% endfor %}

        </tbody>

      </table>
      {% else %}
      <div class='col-lg-12 text-center '>
        {% if request.GET.q %}
        <h2> Could not find any results for {{request.GET.q}} </h2>
        {% else %}
        <h2> There are no users </h2>
        {% endif %}
      </div>
      {% endif %}
    </div>

    {% if page_obj %}
    <div class='col-lg-12 '>
      <!-- Pagination -->
      {% include 'snippets/paginator.html' with page_obj=page_obj page_var=page_var beta=request.GET.beta %}
      <br>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}